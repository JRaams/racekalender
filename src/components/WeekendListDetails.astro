---
import { Icon } from 'astro-icon/components';
import { getLangFromUrl, useTranslations } from '~/i18n/utils';
import type { Race } from '~/types';
import { TypeToIconMap } from '~/types/eventtype';
import TimeDisplay from './TimeDisplay.svelte';

type Props = {
  race: Race;
};

const { race } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<table>
  <thead>
    <tr>
      <th scope="col">{t('list.table.type')}</th>
      <th scope="col">{t('list.table.time')}</th>
      <th scope="col" class="lap-column">{t('list.table.laps')}</th>
    </tr>
  </thead>
  <tbody>
    {
      race.events.map((e) => (
        <tr>
          <td>
            <Icon name={TypeToIconMap[e.type] ?? 'material-symbols:brightness-empty'} size={16} />
            {e.name.split(' - ')[0]}
          </td>
          <td>
            <TimeDisplay {lang} timestamp={e.startAt} />
          </td>
          <td>
            <small>{e.laps ?? '-'}</small>
          </td>
        </tr>
      ))
    }
  </tbody>
</table>

<style>
  @media screen and (max-width: 500px) {
    .lap-column {
      width: 0;
    }
  }
</style>
